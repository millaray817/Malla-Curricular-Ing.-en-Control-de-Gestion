
const ramos = document.querySelectorAll(".ramo");

ramos.forEach(ramo => {
  ramo.addEventListener("click", () => {
    if (ramo.classList.contains("bloqueado")) return;

    if (ramo.classList.contains("no-aprobado")) {
      ramo.classList.remove("no-aprobado");
      ramo.classList.add("aprobado");

      // Desbloquear dependientes
      const desbloquear = document.querySelectorAll(`[data-prereq*='${ramo.id}']`);
      desbloquear.forEach(dep => {
        // Si el ramo tenía varios prerequisitos, desbloquear solo si todos están aprobados
        const prereqs = dep.dataset.prereq.split(",");
        const todosAprobados = prereqs.every(pr => document.getElementById(pr).classList.contains("aprobado"));
        if (todosAprobados) {
          dep.classList.remove("bloqueado");
          dep.classList.add("no-aprobado");
        }
      });

    } else if (ramo.classList.contains("aprobado")) {
      // Permitir deshacer aprobación
      ramo.classList.remove("aprobado");
      ramo.classList.add("no-aprobado");
    }
  });
});
